<!DOCTYPE html>
<html>
<head>
  <title>readme.md</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "node_modules/append-transform/readme.md";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h1">
        <a href="#append-transform">append-transform  </a>
      </div>

      <div class="heading h2">
        <a href="#install">Install</a>
      </div>

      <div class="heading h2">
        <a href="#usage">Usage</a>
      </div>

      <div class="heading h2">
        <a href="#api">API</a>
      </div>

      <div class="heading h3">
        <a href="#appendtransform-transformfn-extension">appendTransform(transformFn, [extension])</a>
      </div>

      <div class="heading h4">
        <a href="#transformfn">transformFn</a>
      </div>

      <div class="heading h4">
        <a href="#extension">extension</a>
      </div>

      <div class="heading h2">
        <a href="#license">License</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="docs markdown"><div class="pilwrap" id="append-transform">
  <h1>
    <a href="#append-transform" name="append-transform" class="pilcrow"></a>
append-transform <a href="https://travis-ci.org/jamestalmage/append-transform"><img src="https://travis-ci.org/jamestalmage/append-transform.svg?branch=master" alt="Build Status"></a> <a href="https://coveralls.io/github/jamestalmage/append-transform?branch=master"><img src="https://coveralls.io/repos/jamestalmage/append-transform/badge.svg?branch=master&amp;service=github" alt="Coverage Status"></a>
  </h1>
</div>
<blockquote>
<p>Install a transform to <code>require.extensions</code> that always runs last, even if additional extensions are added later.</p>
</blockquote>
<p>The <a href="https://gist.github.com/jamestalmage/df922691475cff66c7e6">typical require extension</a> looks something like this:</p>
<pre><code class="js">  <span class="hljs-keyword">var</span> myTransform = <span class="hljs-built_in">require</span>(<span class="hljs-string">'my-transform'</span>);
  
  <span class="hljs-keyword">var</span> oldExtension = <span class="hljs-built_in">require</span>.extensions[<span class="hljs-string">'.js'</span>];
  <span class="hljs-built_in">require</span>.extensions[<span class="hljs-string">'.js'</span>] = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">module, filename</span>) </span>{
    <span class="hljs-keyword">var</span> oldCompile = <span class="hljs-built_in">module</span>._compile;
    <span class="hljs-built_in">module</span>._compile = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">code, filename</span>) </span>{
      code = myTransform(code);
      <span class="hljs-built_in">module</span>._compile = oldCompile;
      <span class="hljs-built_in">module</span>._compile(code, filename);
    };  
    oldExtension(<span class="hljs-built_in">module</span>, filename);
  };
</code></pre>
<p>In <strong>almost</strong> all cases, that is sufficient and is the method that should be used (check out <a href="https://www.npmjs.com/package/pirates"><code>pirates</code></a> for an easy way to do it correctly). In <strong>rare</strong> cases you must ensure your transform remains the last one, even if other transforms are added later. For example, <code>nyc</code> uses this module to ensure its transform is applied last so it can capture the final source-map information, and ensure any language extensions it can't understand are already transpiled (ES2015 via <code>babel</code> for instance).</p>
<p><em>WARNING:</em> You should be sure you  <em>actually</em> need this, as it takes control away from the user. Your transform remains the last one applied, even as users continue to add more transforms. This is potentially confusing. Coverage libraries like <code>nyc</code> (and <code>istanbul</code> on which it relies) have valid reasons for doing this, but you should prefer conventional transform installation via <a href="https://www.npmjs.com/package/pirates"><code>pirates</code></a>.</p>
<p>References:</p>
<ul>
<li><a href="https://gist.github.com/jamestalmage/df922691475cff66c7e6">Detailed Breakdown of How Require Extensions Work</a></li>
<li>The <a href="https://github.com/jamestalmage/append-transform/blob/master/test/execution-order.js">test suite</a> provides a good overview of how this library manipulates the order in which transforms are applied.</li>
</ul>
<div class="pilwrap" id="install">
  <h2>
    <a href="#install" name="install" class="pilcrow"></a>
Install
  </h2>
</div>
<pre><code>$ npm install --save append-transform
</code></pre>
<div class="pilwrap" id="usage">
  <h2>
    <a href="#usage" name="usage" class="pilcrow"></a>
Usage
  </h2>
</div>
<pre><code class="js"><span class="hljs-keyword">var</span> appendTransform = <span class="hljs-built_in">require</span>(<span class="hljs-string">'append-transform'</span>);
<span class="hljs-keyword">var</span> myTransform = <span class="hljs-built_in">require</span>(<span class="hljs-string">'my-transform'</span>);

appendTransform(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">code, filename</span>) </span>{
  <span class="hljs-keyword">if</span> (myTransform.shouldTransform(filename)) {
    code = myTransform.transform(code);
  }
  <span class="hljs-keyword">return</span> code;
});
</code></pre>
<div class="pilwrap" id="api">
  <h2>
    <a href="#api" name="api" class="pilcrow"></a>
API
  </h2>
</div>
<div class="pilwrap" id="appendtransform-transformfn-extension">
  <h3>
    <a href="#appendtransform-transformfn-extension" name="appendtransform-transformfn-extension" class="pilcrow"></a>
appendTransform(transformFn, [extension])
  </h3>
</div>
<div class="pilwrap" id="transformfn">
  <h4>
    <a href="#transformfn" name="transformfn" class="pilcrow"></a>
transformFn
  </h4>
</div>
<p>Type: <code>function(code: string, filename: string)</code><br>
<em>Required</em></p>
<p>A callback that modifies the incoming <code>code</code> argument in some way, and returns the transformed result. <code>filename</code> is provided to filter which files the transform applies to. If a transform should not manipulate a particular file, just return <code>code</code> without modifying it. It is fairly common to avoid transforming files in <code>node_modules</code>. In that case you may want to use <a href="https://www.npmjs.com/package/node-modules-regexp"><code>node-modules-regexp</code></a> to help reliably detect <code>node_modules</code> paths and avoid transforming them.</p>
<div class="pilwrap" id="extension">
  <h4>
    <a href="#extension" name="extension" class="pilcrow"></a>
extension
  </h4>
</div>
<p>Type: <code>string</code><br>
Default: <code>&quot;.js&quot;</code></p>
<p>The extension for the types of files this transform is capable of handling.</p>
<div class="pilwrap" id="license">
  <h2>
    <a href="#license" name="license" class="pilcrow"></a>
License
  </h2>
</div>
<p>MIT Â© <a href="http://github.com/jamestalmage">James Talmage</a></p>
</div>
  </div>
</body>
</html>
