<!DOCTYPE html>
<html>
<head>
  <title>index.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "node_modules/eslint-loader/index.js";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>index.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-meta">"use strict"</span>

<span class="hljs-keyword">var</span> assign = <span class="hljs-built_in">require</span>(<span class="hljs-string">"object-assign"</span>)
<span class="hljs-keyword">var</span> loaderUtils = <span class="hljs-built_in">require</span>(<span class="hljs-string">"loader-utils"</span>)
<span class="hljs-keyword">var</span> objectHash = <span class="hljs-built_in">require</span>(<span class="hljs-string">"object-hash"</span>)
<span class="hljs-keyword">var</span> pkg = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./package.json"</span>)
<span class="hljs-keyword">var</span> createCache = <span class="hljs-built_in">require</span>(<span class="hljs-string">"loader-fs-cache"</span>)
<span class="hljs-keyword">var</span> cache = createCache(<span class="hljs-string">"eslint-loader"</span>)

<span class="hljs-keyword">var</span> engines = {}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<div class="dox">
<div class="summary">
<p>Class representing an ESLintError.</p>
</div>
<div class="body">
</div>
<div class="details">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ESLintError</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Error</span> </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<div class="dox">
<div class="summary">
<p>Create an ESLintError.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">messages</span>
<span class="dox_type">string</span>
<span><ul>
<li>Formatted eslint errors.</li>
</ul>
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">constructor</span>(messages) {
    <span class="hljs-keyword">super</span>()
    <span class="hljs-keyword">this</span>.name = <span class="hljs-string">"ESLintError"</span>
    <span class="hljs-keyword">this</span>.message = messages
    <span class="hljs-keyword">this</span>.stack = <span class="hljs-string">""</span>
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<div class="dox">
<div class="summary">
<p>Returns a stringified representation of our error. This method is called
when an error is consumed by console methods
ex: console.error(new ESLintError(formattedMessage))</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span class="dox_type">string</span>
<span>error - A stringified representation of the error.
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">  inspect() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.message
  }
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<div class="dox">
<div class="summary">
<p>printLinterOutput</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">eslint.executeOnText</span>
<span class="dox_type">Object</span>
<span>return value
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">config</span>
<span class="dox_type">Object</span>
<span>eslint configuration
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">webpack</span>
<span class="dox_type">Object</span>
<span>webpack instance
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">printLinterOutput</span>(<span class="hljs-params">res, config, webpack</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>skip ignored file warning</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (
    !(res.warningCount === <span class="hljs-number">1</span> &amp;&amp;
      res.results[<span class="hljs-number">0</span>].messages[<span class="hljs-number">0</span>] &amp;&amp;
      res.results[<span class="hljs-number">0</span>].messages[<span class="hljs-number">0</span>].message &amp;&amp;
      res.results[<span class="hljs-number">0</span>].messages[<span class="hljs-number">0</span>].message.indexOf(<span class="hljs-string">"ignore"</span>) &gt; <span class="hljs-number">1</span>)
  ) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>quiet filter done now
eslint allow rules to be specified in the input between comments
so we can found warnings defined in the input itself</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">if</span> (res.warningCount &amp;&amp; config.quiet) {
      res.warningCount = <span class="hljs-number">0</span>
      res.results[<span class="hljs-number">0</span>].warningCount = <span class="hljs-number">0</span>
      res.results[<span class="hljs-number">0</span>].messages = res.results[<span class="hljs-number">0</span>].messages.filter(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">
        message
      </span>) </span>{
        <span class="hljs-keyword">return</span> message.severity !== <span class="hljs-number">1</span>
      })
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>if enabled, use eslint auto-fixing where possible</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">if</span> (config.fix &amp;&amp; res.results[<span class="hljs-number">0</span>].output) {
      <span class="hljs-keyword">var</span> eslint = <span class="hljs-built_in">require</span>(config.eslintPath)
      eslint.CLIEngine.outputFixes(res)
    }

    <span class="hljs-keyword">if</span> (res.errorCount || res.warningCount) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<p>add filename for each results so formatter can have relevant filename</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      res.results.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">r</span>) </span>{
        r.filePath = webpack.resourcePath
      })
      <span class="hljs-keyword">var</span> messages = config.formatter(res.results)

      <span class="hljs-keyword">if</span> (config.outputReport &amp;&amp; config.outputReport.filePath) {
        <span class="hljs-keyword">var</span> reportOutput
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<p>if a different formatter is passed in as an option use that</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">if</span> (config.outputReport.formatter) {
          reportOutput = config.outputReport.formatter(res.results)
        }
        <span class="hljs-keyword">else</span> {
          reportOutput = messages
        }
        <span class="hljs-keyword">var</span> filePath = loaderUtils.interpolateName(webpack,
          config.outputReport.filePath, {
            <span class="hljs-attr">content</span>: res.results.map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">r</span>) </span>{
              <span class="hljs-keyword">return</span> r.source
            }).join(<span class="hljs-string">"\n"</span>),
          }
        )
        webpack.emitFile(filePath, reportOutput)
      }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11"></a>
</div>
<p>default behavior: emit error only if we have errors</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      <span class="hljs-keyword">var</span> emitter = res.errorCount ? webpack.emitError : webpack.emitWarning

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12"></a>
</div>
<p>force emitError or emitWarning if user want this</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      <span class="hljs-keyword">if</span> (config.emitError) {
        emitter = webpack.emitError
      }
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (config.emitWarning) {
        emitter = webpack.emitWarning
      }

      <span class="hljs-keyword">if</span> (emitter) {
        <span class="hljs-keyword">if</span> (config.failOnError &amp;&amp; res.errorCount) {
          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ESLintError(
            <span class="hljs-string">"Module failed because of a eslint error.\n"</span> + messages
          )
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (config.failOnWarning &amp;&amp; res.warningCount) {
          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ESLintError(
            <span class="hljs-string">"Module failed because of a eslint warning.\n"</span> + messages
          )
        }

        emitter(webpack.version === <span class="hljs-number">2</span> ? <span class="hljs-keyword">new</span> ESLintError(messages) : messages)
      }
      <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(
          <span class="hljs-string">"Your module system doesn't support emitWarning. "</span> +
            <span class="hljs-string">"Update available? \n"</span> +
            messages
        )
      }
    }
  }
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13"></a>
</div>
<div class="dox">
<div class="summary">
<p>webpack loader</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">input</span>
<span class="dox_type">String</span>
<span class="dox_type">Buffer</span>
<span>JavaScript string
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">map</span>
<span class="dox_type">Object</span>
<span>input source map
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">input, map</span>) </span>{
  <span class="hljs-keyword">var</span> webpack = <span class="hljs-keyword">this</span>

  <span class="hljs-keyword">var</span> userOptions = assign(
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14"></a>
</div>
<p>user defaults</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">this</span>.options.eslint || {},
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15"></a>
</div>
<p>loader query string</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    loaderUtils.getOptions(<span class="hljs-keyword">this</span>)
  )

  <span class="hljs-keyword">var</span> config = assign(
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16"></a>
</div>
<p>loader defaults</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    {
      <span class="hljs-attr">formatter</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">"eslint/lib/formatters/stylish"</span>),
      <span class="hljs-attr">cacheIdentifier</span>: <span class="hljs-built_in">JSON</span>.stringify({
        <span class="hljs-string">"eslint-loader"</span>: pkg.version,
        <span class="hljs-attr">eslint</span>: <span class="hljs-built_in">require</span>(userOptions.eslintPath || <span class="hljs-string">"eslint"</span>).version,
      }),
      <span class="hljs-attr">eslintPath</span>: <span class="hljs-string">"eslint"</span>,
    },
    userOptions
  )

  <span class="hljs-keyword">var</span> cacheDirectory = config.cache
  <span class="hljs-keyword">var</span> cacheIdentifier = config.cacheIdentifier

  <span class="hljs-keyword">delete</span> config.cacheDirectory
  <span class="hljs-keyword">delete</span> config.cacheIdentifier

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17"></a>
</div>
<p>Create the engine only once per config</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">var</span> configHash = objectHash(config)
  <span class="hljs-keyword">if</span> (!engines[configHash]) {
    <span class="hljs-keyword">var</span> eslint = <span class="hljs-built_in">require</span>(config.eslintPath)
    engines[configHash] = <span class="hljs-keyword">new</span> eslint.CLIEngine(config)
  }

  <span class="hljs-keyword">this</span>.cacheable()

  <span class="hljs-keyword">var</span> resourcePath = webpack.resourcePath
  <span class="hljs-keyword">var</span> cwd = process.cwd()

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18"></a>
</div>
<p>remove cwd from resource path in case webpack has been started from project
root, to allow having relative paths in .eslintignore</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (resourcePath.indexOf(cwd) === <span class="hljs-number">0</span>) {
    resourcePath = resourcePath.substr(cwd.length + <span class="hljs-number">1</span>)
  }

  <span class="hljs-keyword">var</span> engine = engines[configHash]
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19"></a>
</div>
<p>return early if cached</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (config.cache) {
    <span class="hljs-keyword">var</span> callback = <span class="hljs-keyword">this</span>.async()
    <span class="hljs-keyword">return</span> cache(
      {
        <span class="hljs-attr">directory</span>: cacheDirectory,
        <span class="hljs-attr">identifier</span>: cacheIdentifier,
        <span class="hljs-attr">options</span>: config,
        <span class="hljs-attr">source</span>: input,
        <span class="hljs-attr">transform</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">return</span> lint(engine, input, resourcePath)
        },
      },
      <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, res</span>) </span>{
        <span class="hljs-keyword">if</span> (err) {
          <span class="hljs-keyword">return</span> callback(err)
        }
        printLinterOutput(res || {}, config, webpack)
        <span class="hljs-keyword">return</span> callback(<span class="hljs-literal">null</span>, input, map)
      }
    )
  }
  printLinterOutput(lint(engine, input, resourcePath), config, <span class="hljs-keyword">this</span>)
  <span class="hljs-keyword">this</span>.callback(<span class="hljs-literal">null</span>, input, map)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">lint</span>(<span class="hljs-params">engine, input, resourcePath</span>) </span>{
  <span class="hljs-keyword">return</span> engine.executeOnText(input, resourcePath, <span class="hljs-literal">true</span>)
}

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
